TODO: refactor into `comm` and elsewhere
