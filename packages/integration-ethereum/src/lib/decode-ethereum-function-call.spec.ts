import {
  RPCMessage,
  decode,
  decodeRpcMessage,
  decodeTokenByAssetClass,
} from "./decode-ethereum-function-call"

const goerliChainId = "00x5"
// SKIP: https://app.shortcut.com/the-internet-portal/story/11881/remove-rarible-unit-tests
// @Dmitrii to take a look and probably remove
describe.skip("Decode function call data.", () => {
  jest.setTimeout(60000)

  beforeEach(async () => {
    await waitOneSecond()
  })

  it("should return decoded approve request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x3d47d0475192d8245020287eedb81f66efca35a8",
          data: "0x095ea7b300000000000000000000000017cef9a8bf107d58e87c170be1652c06390bd990ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
          to: "0xcfaf03b6254363bca1a9d8e529270b5660bf3109",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x1e471e2eac",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "Approve",
      method: "approve",
      from: "0x3d47d0475192d8245020287eedb81f66efca35a8",
      to: "0xcfaf03b6254363bca1a9d8e529270b5660bf3109",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        spender: "0x17cEf9a8bf107D58E87c170be1652c06390BD990",
        amount:
          "115792089237316195423570985008687907853269984665640564039457584007913129639935",
      },
    })
  })

  it("should return decoded SetApprovalForAll request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x3d47d0475192d8245020287eedb81f66efca35a8",
          data: "0xa22cb46500000000000000000000000021b0b84ffab5a8c48291f5ec9d9fdb9aef5740520000000000000000000000000000000000000000000000000000000000000001",
          to: "0xc3e4214dd442136079df06bb2529bae276d37564",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x5c273fadd6",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "SetApprovalForAll",
      method: "setApprovalForAll",
      from: "0x3d47d0475192d8245020287eedb81f66efca35a8",
      to: "0xc3e4214dd442136079df06bb2529bae276d37564",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        operator: "0x21B0B84FfAB5A8c48291f5eC9D9FDb9aef574052",
        approved: true,
      },
    })
  })

  it("should return decoded mint 1155 lazy request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_signTypedData_v4",
      params: [
        "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
        '{"types":{"EIP712Domain":[{"type":"string","name":"name"},{"type":"string","name":"version"},{"type":"uint256","name":"chainId"},{"type":"address","name":"verifyingContract"}],"Part":[{"name":"account","type":"address"},{"name":"value","type":"uint96"}],"Mint1155":[{"name":"tokenId","type":"uint256"},{"name":"supply","type":"uint256"},{"name":"tokenURI","type":"string"},{"name":"creators","type":"Part[]"},{"name":"royalties","type":"Part[]"}]},"domain":{"name":"Mint1155","version":"1","chainId":5,"verifyingContract":"0x37118eb660ef57a916c73a3029631247286207e5"},"primaryType":"Mint1155","message":{"contract":"0x37118eb660ef57a916c73a3029631247286207e5","uri":"/1","royalties":[],"creators":[{"account":"0xdc75e8c3ae765d8947adbc6698a2403a6141d439","value":10000}],"tokenId":"99717154275612763355594541302162896521073660691220745561728655981262019756033","@type":"ERC1155","supply":"1","tokenURI":"/1"}}',
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "MintLazy1155",
      method: "Mint1155",
      from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
      data: {
        contract: "0x37118eb660ef57a916c73a3029631247286207e5",
        tokenId:
          "99717154275612763355594541302162896521073660691220745561728655981262019756033",
        uri: "/1",
        supply: "1",
        account: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
        creators: [
          {
            account: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
            value: 10000,
          },
        ],
        royalties: [],
      },
    })
  })

  it("should return decoded batch buy request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
          to: "0x792936889ce1759e87d33035205c5fff08a07e32",
          data: "0xb94ee3320000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016345785d8a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000004440d5f7d350000000000000000000000000000000000000000000000000000000000000020000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d4390000000000000000000000000000000000000000000000000000000000000001973bb6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000000000000000000000000000000000000118711e6a3a563b8a55ee0522296424c9a040372698a85925ace5c15d109b65000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002fa3cfd30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000016345785d8a00000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000038000000000000000000000000000000000000000000000000000000000000000400000000000000000000000008a1d516d73fb36227d6ded260888c42bb7c55cfa1cbc160eb6699ab0528bbfde0b65db6c117f511800000000000000000000000400000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e812345678900000000000000000000000000123456789face09616c6c646174610000000000000000000000000000000000000000000000000000000000000041a7e0faf10894c726ad1f9a4869559234867e353b4456676cbaed4d3b9fbbc945274a5bbc99035c90da3bbd7cfae2be4ecb6eafc5074e303f8c38f660d10361e11b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000002710dc75e8c3ae765d8947adbc6698a2403a6141d4390000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461",
          gas: "0x38185",
          value: "0x16345785d8a0000",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x22cd278be0",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "BatchBuyRequest",
      method: "bulkPurchase",
      from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
      to: "0x792936889ce1759e87d33035205c5fff08a07e32",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: "0.1",
      data: {
        allowFail: true,
        feeRecipientFirst: 0,
        feeRecipientSecond: 0,
        items: [
          {
            amount: "100000000000000000",
            fees: "0",
            marketId: 0,
            item: {
              interface: "Item",
              method: "directPurchase",
              data: expect.objectContaining({
                id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa:12997079243578958014486847546347798191014225278195692514948617470507594285060",
                collectionData: expect.objectContaining({
                  id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa",
                }),
              }),
            },
          },
        ],
      },
    })
  })

  it("should return decoded deploy private collection request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
          data: "0x72397ad500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000016052d56e1f400889d44744e970daa5c9d5a0fc62cd1f4ba10e9f22c7123090ae18000000000000000000000000000000000000000000000000000000000000000a436f6c6c656374696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054d59434f4c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d00000000000000000000000000",
          to: "0x66a1037a48b6a2469cf740ad9ac42bd47edf9573",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x3d7dd4c5d4",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "CollectionRequest",
      method: "createToken",
      from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
      to: "0x66a1037a48b6a2469cf740ad9ac42bd47edf9573",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        name: "Collection",
        symbol: "MYCOL",
        baseURI: "https://example.com",
        contractURI: "https://example.com",
        isPrivate: true,
      },
    })
  })

  it("should return decoded accept bid request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
          to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
          data: "0x67d49a3b0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d4390000000000000000000000000000000000000000000000000000000000000001973bb6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d62fa023bf6ff483245ac158805e97cd874d7ce0d2a7c952c1123607a7534f653f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b18cdf600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000016345785d8a00000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000036000000000000000000000000000000000000000000000000000000000000000400000000000000000000000008a1d516d73fb36227d6ded260888c42bb7c55cfa1cbc160eb6699ab0528bbfde0b65db6c117f5118000000000000000000000004000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c646174610000000000000000000000000000000000000000000000000000000000000041d149daac624be8205223463cea115fa852d58ec9a0161be0862d0c7a0b8e7eac4bd2bd761d76af1e606e5af28b46d7fd00b993ec33e6e5eaa205e0240b01b7181b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x4893d03266",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "DirectAcceptBid",
      method: "directAcceptBid",
      from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
      to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        bidData:
          "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461",
        bidDataType: "0x1b18cdf6",
        bidEnd: "0",
        bidMaker: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
        bidNftAmount: "1",
        bidPaymentAmount: "100000000000000000",
        bidSalt:
          "21541646136040263732075538239229382108123546067974428832547316847771240064319",
        bidSignature:
          "0xd149daac624be8205223463cea115fa852d58ec9a0161be0862d0c7a0b8e7eac4bd2bd761d76af1e606e5af28b46d7fd00b993ec33e6e5eaa205e0240b01b7181b",
        bidStart: "0",
        nft: {
          interface: "Item",
          method: "sell",
          data: expect.objectContaining({
            id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa:12997079243578958014486847546347798191014225278195692514948617470507594285060",
            collectionData: expect.objectContaining({
              id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa",
            }),
          }),
        },
        paymentToken: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
        sellOrderData:
          "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000",
        sellOrderNftAmount: "1",
        sellOrderPaymentAmount: "100000000000000000",
      },
    })
  })

  it("should return decoded cancel request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
          data: "0xe2864fe30000000000000000000000000000000000000000000000000000000000000020000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d439000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200babb9a2c9020f7f9c5e28d1cef7919488ceaa574190632344198f2ec38913d0c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002fa3cfd30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000173ad21460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000d8560c88d1dc85f9ed05b25878e366c49b68bef9c13b70a3198195039090338d3acffae592b6d3df0000000000000000000000010000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000016345785d8a0000aaaebeba000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e812345678900000000000000000000000000123456789face09616c6c64617461",
          to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x3879c06830",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "CancelOrder",
      method: "cancel",
      from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
      to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        maker: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
        makeAsset: {
          interface: "Item",
          method: "sell",
          data: expect.objectContaining({
            id: "ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9:87401401146140599190027576524444199286040691005263462825477828207247490023425",
            collectionData: expect.objectContaining({
              id: "ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9",
            }),
          }),
        },
        taker: "0x0000000000000000000000000000000000000000",
        takeAssetPrice: "100000000000000000",
        salt: "84461654307954697726799980201460501792639563044917131997224410854683107736844",
        start: "0",
        end: "0",
      },
    })
  })

  it("should return decoded mint request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
          data: "0x22a775b60000000000000000000000000000000000000000000000000000000000000040000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d439dc75e8c3ae765d8947adbc6698a2403a6141d43900000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000022f310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d43900000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000",
          to: "0xc6fd791bac6115aeb051308b0be8003929c1fdb0",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x2ea3d9148a",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "MintRequest",
      method: "mintAndTransfer",
      from: "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
      to: "0xc6fd791bac6115aeb051308b0be8003929c1fdb0",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        tokenId:
          "99717154275612763355594541302162896521073660691220745561728655981262019756033",
        tokenURI: "/1",
        creators: [
          {
            creator: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
            value: "10000",
          },
        ],
        royalties: [],
        signatures: ["0x"],
        to: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
      },
    })
  })

  it("should return decoded buy request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x382901144a77bec53493fa090053b9c63da5dd07",
          to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
          data: "0x0d5f7d35000000000000000000000000000000000000000000000000000000000000002000000000000000000000000029fe67f3d594c86c1d4f52ef0d6bb3a0275d3451000000000000000000000000000000000000000000000000000000000000000173ad21460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000c8e20c7457f8800000000000000000000000000000000000000000000000000000000000000000ffb1f8a24485d689494ca9ea3bc73be5e824593e5ae722f1b38dfd3b80c8722c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023d235ef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000c8e20c7457f880000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000d5835369d4f691094d7509296cfc4da19efe46180000000000000000000000000000000000000000000000000000000000002c4f00000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041348dc3e5d69f8d542619ab568893fde1d7e360457a0683024132f024677876742c6b44e6b025ad6907f1c3e5a204312f75df88331592f2d189dfd272ffed00951c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461",
          value: "0xc8e20c7457f880",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x33bd5259da",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "Item",
      method: "directPurchase",
      from: "0x382901144a77bec53493fa090053b9c63da5dd07",
      to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: "0.05654353846153843",
      data: expect.objectContaining({
        blockchain: "ETHEREUM",
        collection: expect.stringMatching(
          /ETHEREUM:0xd5835369d4f691094d7509296cfc4da19efe4618/i,
        ),
        contract: expect.stringMatching(
          /ETHEREUM:0xd5835369d4f691094d7509296cfc4da19efe4618/i,
        ),
        tokenId: expect.stringMatching(/11343/i),
      }),
    })
  })

  it("should return decoded transfer request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x1a90e5cd839d61b167d516108606456c2d06d369",
          data: "0xf242432a0000000000000000000000001a90e5cd839d61b167d516108606456c2d06d369000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d4391cbc160eb6699ab0528bbfde0b65db6c117f5118000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000",
          to: "0x8a1d516d73fb36227d6ded260888c42bb7c55cfa",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0xf7fdb4316",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "SafeTransferFrom",
      method: "safeTransferFrom",
      from: "0x1a90e5cd839d61b167d516108606456c2d06d369",
      to: "0x8a1d516d73fb36227d6ded260888c42bb7c55cfa",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        amount: "1",
        data: "0x00",
        from: "0x1A90e5cd839d61b167D516108606456C2d06d369",
        id: "12997079243578958014486847546347798191014225278195692514948617470507594285060",
        to: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
      },
    })
  })

  it("should return decoded burn request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x382901144a77bec53493fa090053b9c63da5dd07",
          data: "0x42966c683eb89979bd2468b0fc0ed83cbf3fec379969c5e3000000000000000000000012",
          to: "0xd8560c88d1dc85f9ed05b25878e366c49b68bef9",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x311bd91e26",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "Burn",
      method: "burn",
      from: "0x382901144a77bec53493fa090053b9c63da5dd07",
      to: "0xd8560c88d1dc85f9ed05b25878e366c49b68bef9",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        tokenId:
          "28369555721345345376156468705960426739116538599175521796431207211942537068562",
      },
    })
  })

  it("should return decoded deploy collection request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x1a90e5cd839d61b167d516108606456c2d06d369",
          data: "0x27050d1f00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c04662415debc8dcc9714d50a26c79cbf0fc640e2e7c6f5384cca4bbd82f84af75000000000000000000000000000000000000000000000000000000000000000a436f6c6c656374696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054d59434f4c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
          to: "0x66a1037a48b6a2469cf740ad9ac42bd47edf9573",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x13bab3cf40",
        },
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "CollectionRequest",
      method: "createToken",
      from: "0x1a90e5cd839d61b167d516108606456c2d06d369",
      to: "0x66a1037a48b6a2469cf740ad9ac42bd47edf9573",
      maxFeePerGas: expect.any(String),
      maxPriorityFeePerGas: "2.5e-9",
      value: undefined,
      data: {
        name: "Collection",
        symbol: "MYCOL",
        baseURI: "https://example.com",
        contractURI: "https://example.com",
        isPrivate: false,
      },
    })
  })

  it("should return decoded sell request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_signTypedData_v4",
      params: [
        "0x1A90e5cd839d61b167D516108606456C2d06d369",
        '{"primaryType":"Order","domain":{"name":"Exchange","version":"2","verifyingContract":"0x02afbd43cad367fcb71305a2dfb9a3928218f0c1","chainId":5},"types":{"EIP712Domain":[{"type":"string","name":"name"},{"type":"string","name":"version"},{"type":"uint256","name":"chainId"},{"type":"address","name":"verifyingContract"}],"AssetType":[{"name":"assetClass","type":"bytes4"},{"name":"data","type":"bytes"}],"Asset":[{"name":"assetType","type":"AssetType"},{"name":"value","type":"uint256"}],"Order":[{"name":"maker","type":"address"},{"name":"makeAsset","type":"Asset"},{"name":"taker","type":"address"},{"name":"takeAsset","type":"Asset"},{"name":"salt","type":"uint256"},{"name":"start","type":"uint256"},{"name":"end","type":"uint256"},{"name":"dataType","type":"bytes4"},{"name":"data","type":"bytes"}]},"message":{"maker":"0x1a90e5cd839d61b167d516108606456c2d06d369","makeAsset":{"assetType":{"assetClass":"0x973bb640","data":"0x0000000000000000000000008a1d516d73fb36227d6ded260888c42bb7c55cfa1cbc160eb6699ab0528bbfde0b65db6c117f5118000000000000000000000004"},"value":"1"},"taker":"0x0000000000000000000000000000000000000000","takeAsset":{"assetType":{"assetClass":"0xaaaebeba","data":"0x"},"value":"100000000000000000"},"salt":"0x805921e7784d1d564525097f928e20b0b751cabdb9390f729d83edd56bc86d6d","start":0,"end":0,"dataType":"0x2fa3cfd3","data":"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e812345678900000000000000000000000000123456789face09616c6c64617461"}}',
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "Item",
      method: "SellOrder",
      from: "0x1A90e5cd839d61b167D516108606456C2d06d369",
      data: expect.objectContaining({
        blockchain: "ETHEREUM",
        collection: expect.stringMatching(
          /ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa/i,
        ),
        contract: expect.stringMatching(
          /ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa/i,
        ),
        tokenId: expect.stringMatching(
          /12997079243578958014486847546347798191014225278195692514948617470507594285060/i,
        ),
      }),
      total: 0.1,
    })
  })

  it("should throw exception for a buy request with erc20 by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "93eed9f7-7236-4679-8664-1f8ecdf6d9a4",
      method: "eth_sendTransaction",
      params: [
        {
          from: "0x79fd51134b38e4d3e5d39c4edffd5a57ff02dfb9",
          to: "0x02afbd43cad367fcb71305a2dfb9a3928218f0c1",
          data: "0x0d5f7d35000000000000000000000000000000000000000000000000000000000000002000000000000000000000000079fd51134b38e4d3e5d39c4edffd5a57ff02dfb9000000000000000000000000000000000000000000000000000000000000000173ad21460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d6e99ee3db8d027f530cd66879bd14e66ccbfa7fb87d7af9758d8f351a2a4310c3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002fa3cfd30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003800000000000000000000000000000000000000000000000000000000000000040000000000000000000000000c0dcab2615cbc2b0c582598037ffd74760fbeed9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e812345678900000000000000000000000000123456789face09616c6c646174610000000000000000000000000000000000000000000000000000000000000041731ec2b3cac3ef7e3d9f74b220d0ea56222144c1b567424e6e1d7410905c7d25269087cfde6337671cfde700b16460d84d81392bb21f4c55b4bd4fd1dc4459ac1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461",
          maxPriorityFeePerGas: "0x9502F900",
          maxFeePerGas: "0x9502ff32",
        },
      ],
      options: {
        chainId: "0x05",
        rpcUrl: "https://goerli-ethereum-node.rarible.com",
      },
    }

    await expect(decodeRpcMessage(request)).rejects.toThrow(
      "Not a native token.",
    )
  })

  it("should throw exception for a sell request with erc20 by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "16311a7a-472e-4053-912c-96052f858484",
      method: "eth_signTypedData_v4",
      params: [
        "0x79fd51134B38e4D3e5D39C4edfFD5A57ff02DFB9",
        '{"primaryType":"Order","domain":{"name":"Exchange","version":"2","verifyingContract":"0x02afbd43cad367fcb71305a2dfb9a3928218f0c1","chainId":5},"types":{"EIP712Domain":[{"type":"string","name":"name"},{"type":"string","name":"version"},{"type":"uint256","name":"chainId"},{"type":"address","name":"verifyingContract"}],"AssetType":[{"name":"assetClass","type":"bytes4"},{"name":"data","type":"bytes"}],"Asset":[{"name":"assetType","type":"AssetType"},{"name":"value","type":"uint256"}],"Order":[{"name":"maker","type":"address"},{"name":"makeAsset","type":"Asset"},{"name":"taker","type":"address"},{"name":"takeAsset","type":"Asset"},{"name":"salt","type":"uint256"},{"name":"start","type":"uint256"},{"name":"end","type":"uint256"},{"name":"dataType","type":"bytes4"},{"name":"data","type":"bytes"}]},"message":{"maker":"0x79fd51134b38e4d3e5d39c4edffd5a57ff02dfb9","makeAsset":{"assetType":{"assetClass":"0x73ad2146","data":"0x000000000000000000000000c0dcab2615cbc2b0c582598037ffd74760fbeed90000000000000000000000000000000000000000000000000000000000000000"},"value":"1"},"taker":"0x0000000000000000000000000000000000000000","takeAsset":{"assetType":{"assetClass":"0x8ae85d84","data":"0x000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d6"},"value":"100000000000000000"},"salt":"0xe99ee3db8d027f530cd66879bd14e66ccbfa7fb87d7af9758d8f351a2a4310c3","start":0,"end":0,"dataType":"0x2fa3cfd3","data":"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e812345678900000000000000000000000000123456789face09616c6c64617461"}}',
      ],
      options: {
        chainId: "0x05",
        rpcUrl: "https://goerli-ethereum-node.rarible.com",
      },
    }

    await expect(decodeRpcMessage(request)).rejects.toThrow(
      "Not a native token.",
    )
  })

  it("should throw exception for a bid request with erc20 by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_signTypedData_v4",
      params: [
        "0xdc75e8c3ae765d8947adbc6698a2403a6141d439",
        '{"primaryType":"Order","domain":{"name":"Exchange","version":"2","verifyingContract":"0x02afbd43cad367fcb71305a2dfb9a3928218f0c1","chainId":5},"types":{"EIP712Domain":[{"type":"string","name":"name"},{"type":"string","name":"version"},{"type":"uint256","name":"chainId"},{"type":"address","name":"verifyingContract"}],"AssetType":[{"name":"assetClass","type":"bytes4"},{"name":"data","type":"bytes"}],"Asset":[{"name":"assetType","type":"AssetType"},{"name":"value","type":"uint256"}],"Order":[{"name":"maker","type":"address"},{"name":"makeAsset","type":"Asset"},{"name":"taker","type":"address"},{"name":"takeAsset","type":"Asset"},{"name":"salt","type":"uint256"},{"name":"start","type":"uint256"},{"name":"end","type":"uint256"},{"name":"dataType","type":"bytes4"},{"name":"data","type":"bytes"}]},"message":{"maker":"0xdc75e8c3ae765d8947adbc6698a2403a6141d439","makeAsset":{"assetType":{"assetClass":"0x8ae85d84","data":"0x000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d6"},"value":"10000000000000000"},"taker":"0x0000000000000000000000000000000000000000","takeAsset":{"assetType":{"assetClass":"0x973bb640","data":"0x0000000000000000000000008a1d516d73fb36227d6ded260888c42bb7c55cfa1cbc160eb6699ab0528bbfde0b65db6c117f5118000000000000000000000004"},"value":"1"},"salt":"0x715753b2c8acdf0336c15ec4b0e8a57d3f14ae2834d1df75b4478df352212e07","start":0,"end":0,"dataType":"0x1b18cdf6","data":"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"}}',
      ],
    }

    await expect(decodeRpcMessage(request)).rejects.toThrow(
      "Not a native token.",
    )
  })

  it("should return decoded mint721 request by decodeRpcMessage", async () => {
    const request: RPCMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "eth_signTypedData_v4",
      params: [
        "0xBEcedD989418F4D8109920ebC51E12c01CE9978e",
        '{"types":{"EIP712Domain":[{"type":"string","name":"name"},{"type":"string","name":"version"},{"type":"uint256","name":"chainId"},{"type":"address","name":"verifyingContract"}],"Part":[{"name":"account","type":"address"},{"name":"value","type":"uint96"}],"Mint721":[{"name":"tokenId","type":"uint256"},{"name":"tokenURI","type":"string"},{"name":"creators","type":"Part[]"},{"name":"royalties","type":"Part[]"}]},"domain":{"name":"Mint721","version":"1","chainId":5,"verifyingContract":"0x039e28f33fef4b2cc129fec92764549bef558519"},"primaryType":"Mint721","message":{"contract":"0x039e28f33fef4b2cc129fec92764549bef558519","uri":"/bafkreiacj42t6ux5vcxn3ewtmxxo5dj75ova5vgkn56o4hceiwnyucd26i","royalties":[],"creators":[{"account":"0xbecedd989418f4d8109920ebc51e12c01ce9978e","value":10000}],"tokenId":"86304941125615980727754172160686366648346472280739372150188793001574272073730","@type":"ERC721","tokenURI":"/bafkreiacj42t6ux5vcxn3ewtmxxo5dj75ova5vgkn56o4hceiwnyucd26i"}}',
      ],
    }

    const actual = await decodeRpcMessage(request)
    expect(actual).toEqual({
      interface: "MintLazy721",
      method: "Mint721",
      from: "0xBEcedD989418F4D8109920ebC51E12c01CE9978e",
      data: {
        contract: "0x039e28f33fef4b2cc129fec92764549bef558519",
        tokenId:
          "86304941125615980727754172160686366648346472280739372150188793001574272073730",
        uri: "/bafkreiacj42t6ux5vcxn3ewtmxxo5dj75ova5vgkn56o4hceiwnyucd26i",
        creators: [
          {
            account: "0xbecedd989418f4d8109920ebc51e12c01ce9978e",
            value: 10000,
          },
        ],
        royalties: [],
      },
    })
  })

  it("should return cancel order request", async () => {
    const encoded =
      "0xe2864fe30000000000000000000000000000000000000000000000000000000000000020000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d439000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200f23fc9a39a0ac423183ac87be0c1790a9618170fa3e3cc027b7ebbe20c5610eb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002fa3cfd30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000001973bb64000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000400000000000000000000000008a1d516d73fb36227d6ded260888c42bb7c55cfa1cbc160eb6699ab0528bbfde0b65db6c117f511800000000000000000000000400000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000de0b6b3a7640000aaaebeba000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e812345678900000000000000000000000000123456789face09616c6c64617461"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "CancelOrder",
      method: "cancel",
      data: {
        maker: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
        makeAsset: {
          interface: "Item",
          method: "sell",
          data: expect.objectContaining({
            id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa:12997079243578958014486847546347798191014225278195692514948617470507594285060",
            collectionData: expect.objectContaining({
              id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa",
            }),
          }),
        },
        taker: "0x0000000000000000000000000000000000000000",
        takeAssetPrice: "1000000000000000000",
        salt: "109572412383941037706484209286396266693749937366246661834584293059997182857451",
        start: "0",
        end: "0",
      },
    })
  })

  it("should return accept bid request", async () => {
    const encoded =
      "0x67d49a3b0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d439000000000000000000000000000000000000000000000000000000000000000173ad21460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000002386f26fc10000000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d649a42ea63f5a174f77a0fd025f9ee12230066371c3a45fd3d7933fbc554bc9be000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b18cdf600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000002386f26fc10000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003600000000000000000000000000000000000000000000000000000000000000040000000000000000000000000d8560c88d1dc85f9ed05b25878e366c49b68bef93eb89979bd2468b0fc0ed83cbf3fec379969c5e3000000000000000000000012000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461000000000000000000000000000000000000000000000000000000000000004131190526938979801e86b7aff3b6c2e370168671de61e74348b06cbe1e9cf9403292228a201a9e31adb8066d553ae367b0b9cad2ccd86b7c0c006d6f510854db1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "DirectAcceptBid",
      method: "directAcceptBid",
      data: {
        bidData:
          "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461",
        bidDataType: "0x1b18cdf6",
        bidEnd: "0",
        bidMaker: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
        bidNftAmount: "1",
        bidPaymentAmount: "10000000000000000",
        bidSalt:
          "33308922827556936180302928474965367857990788993084799988873425059098267470270",
        bidSignature:
          "0x31190526938979801e86b7aff3b6c2e370168671de61e74348b06cbe1e9cf9403292228a201a9e31adb8066d553ae367b0b9cad2ccd86b7c0c006d6f510854db1c",
        bidStart: "0",
        nft: {
          interface: "Item",
          method: "sell",
          data: expect.objectContaining({
            id: "ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9:28369555721345345376156468705960426739116538599175521796431207211942537068562",
            collectionData: expect.objectContaining({
              id: "ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9",
            }),
          }),
        },
        paymentToken: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
        sellOrderData:
          "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000",
        sellOrderNftAmount: "1",
        sellOrderPaymentAmount: "10000000000000000",
      },
    })
  })

  it("should return burn request", async () => {
    const encoded =
      "0x42966c68b58967989c8e878de4d7e78965e066f26b2d9bf4000000000000000000000002"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "Burn",
      method: "burn",
      data: {
        tokenId:
          "82111398635718818523090306183923969391174023738666600495517475675797389836290",
      },
    })
  })

  it("should return transfer request", async () => {
    const encoded =
      "0xf242432a000000000000000000000000382901144a77bec53493fa090053b9c63da5dd07000000000000000000000000dc75e8c3ae765d8947adbc6698a2403a6141d439843c6b52aea14305d2b9c8ab781a1bf714e98234000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "SafeTransferFrom",
      method: "safeTransferFrom",
      data: {
        amount: "1",
        data: "0x00",
        from: "0x382901144A77BEC53493FA090053B9c63Da5dD07",
        id: "59812047552843277631894088311125038710126744711430293397554259992232364867585",
        to: "0xdC75e8c3aE765D8947aDBC6698a2403A6141D439",
      },
    })
  })

  it("should return batch buy request", async () => {
    const encoded =
      "0xb94ee332000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011c37937e080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000005240d5f7d35000000000000000000000000000000000000000000000000000000000000002000000000000000000000000012b231cd11e525f6a0320fc0864928235a203c7d0000000000000000000000000000000000000000000000000000000000000032973bb6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000003782dace9d9000000000000000000000000000000000000000000000000000000000000000000000d8f39a23d723316642aac461719eff3e792ad54a452bc572a258d7c4a3031e1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000646df4d923d235ef00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000003600000000000000000000000000000000000000000000000000011c37937e08000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000e2de2249cf1c9d76eaf24257b85bbe83bd218a0b00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d6ffd79b52a587a0a9941a61f4e6cb0d386d545800000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000041fd702630bab21665e4c3e3362e3d8cf1b5fea0578e036d9ee0d7d12b66121cae7f6268f6b0eedc985c569f30ddaa9356d1403dd499d50651c848c1904a1582cd1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000382901144a77bec53493fa090053b9c63da5dd070000000000000000000000000000000000000000000000000000000000002710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005af3107a40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000005240d5f7d350000000000000000000000000000000000000000000000000000000000000020000000000000000000000000e213a16b958d5f11bdda167e5850e074f3f583a70000000000000000000000000000000000000000000000000000000000000005973bb6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000001c6bf52634000000000000000000000000000000000000000000000000000000000000000000003007bd48de90ec17adb9f85bf1cc9f95f8808b4f9b9e32c6c57a6cd646af3180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023d235ef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000036000000000000000000000000000000000000000000000000000005af3107a4000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003e000000000000000000000000000000000000000000000000000000000000000400000000000000000000000008a1d516d73fb36227d6ded260888c42bb7c55cfae213a16b958d5f11bdda167e5850e074f3f583a700000000000000000000000d0000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000a0d586e322616c3a4ad7b5a5fcaeb9ed5e9fe9e000000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000410c790e4b6a25db3b6fc75d90f77fc238402f26b9a6bb807e5fd3456db5708d9f4c78277e21b52d1099e8f215e0922b083aa21705ea84710e2c3116fd95a4ae8c1b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000382901144a77bec53493fa090053b9c63da5dd07000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "BatchBuyRequest",
      method: "bulkPurchase",
      data: {
        allowFail: true,
        feeRecipientFirst: 0,
        feeRecipientSecond: 0,
        items: [
          {
            amount: "5000000000000000",
            fees: "0",
            marketId: 0,
            item: {
              interface: "Item",
              method: "directPurchase",
              data: expect.objectContaining({
                id: "ETHEREUM:0xe2de2249cf1c9d76eaf24257b85bbe83bd218a0b:8",
                collectionData: expect.objectContaining({
                  id: "ETHEREUM:0xe2de2249cf1c9d76eaf24257b85bbe83bd218a0b",
                }),
              }),
            },
          },
          {
            amount: "100000000000000",
            fees: "0",
            marketId: 0,
            item: {
              interface: "Item",
              method: "directPurchase",
              data: expect.objectContaining({
                id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa:102257387955674808005262260500339716470980428561394510828930510526251735711757",
                collectionData: expect.objectContaining({
                  id: "ETHEREUM:0x8a1d516d73fb36227d6ded260888c42bb7c55cfa",
                }),
              }),
            },
          },
        ],
      },
    })
  })

  it("should return mint request", async () => {
    const encoded =
      "0x22a775b60000000000000000000000000000000000000000000000000000000000000040000000000000000000000000382901144a77bec53493fa090053b9c63da5dd07382901144a77bec53493fa090053b9c63da5dd0700000000000000000000000300000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000022f350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000382901144a77bec53493fa090053b9c63da5dd0700000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "MintRequest",
      method: "mintAndTransfer",
      data: {
        tokenId:
          "25401967699106481540155849913047907292577987798126179582654568808421886263299",
        tokenURI: "/5",
        creators: [
          {
            creator: "0x382901144A77BEC53493FA090053B9c63Da5dD07",
            value: "10000",
          },
        ],
        royalties: [],
        signatures: ["0x"],
        to: "0x382901144A77BEC53493FA090053B9c63Da5dD07",
      },
    })
  })

  it("should return private collection request.", async () => {
    const encoded =
      "0x72397ad500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000160a1d7182ab23e88ab748788fa082953f2675f2b0ee487ea91fdf1743c023b3657000000000000000000000000000000000000000000000000000000000000000d4d7920436f6c6c656374696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054d59434f4c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d00000000000000000000000000"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "CollectionRequest",
      method: "createToken",
      data: {
        name: "My Collection",
        symbol: "MYCOL",
        baseURI: "https://example.com",
        contractURI: "https://example.com",
        isPrivate: true,
      },
    })
  })

  it("should return public collection request.", async () => {
    const encoded =
      "0x27050d1f00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c0b48b8d153dcbc76af384d7c68859db6a9aaa7e5dbbce62da4be5bd5e85ef1303000000000000000000000000000000000000000000000000000000000000000d4d7920436f6c6c656374696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054d59434f4c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368747470733a2f2f6578616d706c652e636f6d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    const decoded = await decode(encoded, goerliChainId)
    expect(decoded).toEqual({
      interface: "CollectionRequest",
      method: "createToken",
      data: {
        name: "My Collection",
        symbol: "MYCOL",
        baseURI: "https://example.com",
        contractURI: "https://example.com",
        isPrivate: false,
      },
    })
  })

  it("should return buy tokenId for 721_LAZY", async () => {
    const encoded =
      "0x0d5f7d35000000000000000000000000000000000000000000000000000000000000002000000000000000000000000006da1d898598933d6b4bae08e73520f3d9f662c50000000000000000000000000000000000000000000000000000000000000001d8f960c10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000016bcc41e900000000000000000000000000000000000000000000000000000000000000000000e423c57286501476ba845d311d360c9978dde138c742d19b5be39100f7751f330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023d235ef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000056000000000000000000000000000000000000000000000000000016bcc41e90000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000280000000000000000000000000d8560c88d1dc85f9ed05b25878e366c49b68bef9000000000000000000000000000000000000000000000000000000000000004006da1d898598933d6b4bae08e73520f3d9f662c500000000000000000000000800000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000002e516d5764376b485564657831777634347a6a62544661716770487637595772756e795663523752767234316b7737000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000006da1d898598933d6b4bae08e73520f3d9f662c500000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000041e43665d8357025cb9d59f6d52076bff37512554f22b2b07895d3fb371aed9b6518041ca82c1156d11bb93be3331cc7c3c6ec52ad089b3728a88568e53f3456e51b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041a3eda989eddd3246f8b33223fefacca8152d7e32e03f686e1d554eb31ccf03e2390b1a0ced6728c12843a5eccf9a23392b252de162f604bdeb38e8739d8172601c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"
    const actual = await decode(encoded, goerliChainId)
    expect(actual).toEqual(
      expect.objectContaining({
        interface: "Item",
        method: "directPurchase",
        data: expect.objectContaining({
          blockchain: "ETHEREUM",
          collection: expect.stringMatching(
            /ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9/i,
          ),
          contract: expect.stringMatching(
            /ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9/i,
          ),
          tokenId: expect.stringMatching(
            /3099253609847337010599495937138288429512178397116104279154407086947014017032/i,
          ),
        }),
      }),
    )
  })

  it("should return buy tokenId for 1155_LAZY", async () => {
    const encoded =
      "0x0d5f7d3500000000000000000000000000000000000000000000000000000000000000200000000000000000000000007857aeb275ce51f7c3338d9f4d2676a329a021ec00000000000000000000000000000000000000000000000000000000000000151cdfaa400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000b1310c5a2c30000000000000000000000000000000000000000000000000000000000000000000069bf9b535572ee716ee80117dc951e6136bc9d473b2e112e03957286d52afdea0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023d235ef0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004e000000000000000000000000000000000000000000000000000000000000005c0000000000000000000000000000000000000000000000000010e0198eaee00000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000007c4b13b5893cd82f371c5e28f12fb2f37542bbc500000000000000000000000000000000000000000000000000000000000000407857aeb275ce51f7c3338d9f4d2676a329a021ec00000000000000000000005d00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000150000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000000342f697066732f516d664d574c6b6545384d6b65763757527173586574474246395551334a517464414735704c76596e514259673700000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007857aeb275ce51f7c3338d9f4d2676a329a021ec000000000000000000000000000000000000000000000000000000000000271000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007857aeb275ce51f7c3338d9f4d2676a329a021ec00000000000000000000000000000000000000000000000000000000000002580000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000410cfd11fba6c30c1c877a0ee0531bee3271d681c693142c9f01420facda29afe7262aeae17f75dc24d05206dcb5b441393e92c8d78ad0e52e906e1bb6d1f45fd11c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000041ede8c7a3471771fe081d52ba6604f28d38411091cc9f9da4de29c8ef1993865f471fa29ae18d9b366aef39230598ed10670d1758c0da3f8a0f521151ae7733e81b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"
    const actual = await decode(encoded, goerliChainId)

    expect(actual).toEqual(
      expect.objectContaining({
        interface: "Item",
        method: "directPurchase",
        data: expect.objectContaining({
          blockchain: "ETHEREUM",
          collection: expect.stringMatching(
            /ETHEREUM:0x7c4B13B5893cD82f371c5e28f12FB2F37542BbC5/i,
          ),
          contract: expect.stringMatching(
            /ETHEREUM:0x7c4B13B5893cD82f371c5e28f12FB2F37542BbC5/i,
          ),
          tokenId: expect.stringMatching(
            /54432463239768947679520813681406064870422328906862735308373753226626766733405/i,
          ),
        }),
      }),
    )
  })

  it("should return buy tokenId for 1155", async () => {
    const encoded =
      "0x0d5f7d350000000000000000000000000000000000000000000000000000000000000020000000000000000000000000913aa8fe2516752ba1a74a0f1d5168b43977a4310000000000000000000000000000000000000000000000000000000000000001973bb6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000174876e8000000000000000000000000000000000000000000000000000000000000000000daa6bcdee654340b8bdb432562980f51c8395cafa0c36a027210b05bc87400b90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006425cdbf23d235ef0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000360000000000000000000000000000000000000000000000000000000174876e800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000f4910c763ed4e47a585e2d34baa9a4b611ae448cd5be662cf4d6d9722990ca2cdd16bf53ecb943250000000000000a00000000010000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d6ffd79b52a587a0a9941a61f4e6cb0d386d545800000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000412c37d0c3b23b1ef0cf99a8273304923539c483e42a004f915ece1f76f2adefd11888154d97a597ce688dd2644a627d23c8cfaab3cbed10742935c6bded14e2101b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"
    const actual = await decode(encoded, goerliChainId)

    expect(actual).toEqual(
      expect.objectContaining({
        interface: "Item",
        method: "directPurchase",
        data: expect.objectContaining({
          blockchain: "ETHEREUM",
          collection: expect.stringMatching(
            /ETHEREUM:0xf4910C763eD4e47A585E2D34baA9A4b611aE448C/i,
          ),
          contract: expect.stringMatching(
            /ETHEREUM:0xf4910C763eD4e47A585E2D34baA9A4b611aE448C/i,
          ),
          tokenId: expect.stringMatching(
            /96679042880693242821382367246033072756415480234129085295252366780302115209217/i,
          ),
        }),
      }),
    )
  })

  it("should return buy tokenId for 721", async () => {
    const encoded =
      "0x0d5f7d350000000000000000000000000000000000000000000000000000000000000020000000000000000000000000f5156e07f9e10c6a6a308d8fe1ad912e983c534a000000000000000000000000000000000000000000000000000000000000000173ad21460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000003faa2522600000000000000000000000000000000000000000000000000000000000000000001d5a5143913695b0f3cd1bd3695b2311064feb1e994bd8a125f31b01269720860000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023d235ef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000003faa25226000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000d8560c88d1dc85f9ed05b25878e366c49b68bef9be55859659f74e70899c5832b493043361e8c31c00000000000000000000000900000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000415edfafb5e08423c10f853daa2443cd7c8a9595206a90e247028363735e94d79e441e78dbf25dd509446096b94e79e605288d9b875288ed28d5f338a33f7a048c1b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012345678900000000000000000000000000123456789face09616c6c64617461"
    const actual = await decode(encoded, goerliChainId)

    expect(actual).toEqual(
      expect.objectContaining({
        interface: "Item",
        method: "directPurchase",
        data: expect.objectContaining({
          blockchain: "ETHEREUM",
          collection: expect.stringMatching(
            /ETHEREUM:0xD8560C88D1DC85f9ED05b25878E366c49B68bEf9/i,
          ),
          contract: expect.stringMatching(
            /ETHEREUM:0xD8560C88D1DC85f9ED05b25878E366c49B68bEf9/i,
          ),
          tokenId: expect.stringMatching(
            /86090545217057429589019094455964497579787873809883022909766658167983963111433/i,
          ),
        }),
      }),
    )
  })

  it("should return buy tokenId for 721 by assetClass", async () => {
    const type = "0x73ad2146"
    const data =
      "0x000000000000000000000000d8560c88d1dc85f9ed05b25878e366c49b68bef93eb89979bd2468b0fc0ed83cbf3fec379969c5e3000000000000000000000012"
    const actual = await decodeTokenByAssetClass(type, data, goerliChainId)

    expect(actual).toEqual(
      expect.objectContaining({
        interface: "Item",
        method: "sell",
        data: expect.objectContaining({
          blockchain: "ETHEREUM",
          collection: expect.stringMatching(
            /ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9/i,
          ),
          contract: expect.stringMatching(
            /ETHEREUM:0xd8560c88d1dc85f9ed05b25878e366c49b68bef9/i,
          ),
          tokenId: expect.stringMatching(
            /28369555721345345376156468705960426739116538599175521796431207211942537068562/i,
          ),
        }),
      }),
    )
  })

  it("should return signMessage by personal_sign", async () => {
    const rpcMessage = {
      jsonrpc: "2.0",
      id: "",
      options: {
        chainId: "0x05",
      },
      method: "personal_sign",
      params: [
        "0x48656c6c6f20776f726c64",
        "0xc6d2b7df32355d169c15d45d99333248f1be4688",
        null,
      ],
    }
    const actual = await decodeRpcMessage(rpcMessage)

    expect(actual).toEqual({
      interface: "PersonalSign",
      method: "personalSign",
      data: {
        message: "Hello world",
      },
      from: "0xc6d2b7df32355d169c15d45d99333248f1be4688",
    })
  })
})

function waitOneSecond(): Promise<void> {
  return new Promise<void>((resolve) => {
    setTimeout(() => {
      resolve()
    }, 1000)
  })
}
